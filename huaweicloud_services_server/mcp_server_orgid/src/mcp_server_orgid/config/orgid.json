{
  "openapi" : "3.0.0",
  "info" : {
    "description" : "OrgID-OAUTH",
    "title" : "OrgID",
    "version" : "2025-07-30",
    "x-host_prefix" : "orgid-external"
  },
  "servers" : [ {
    "url" : "/"
  } ],
  "components" : {
    "parameters" : { },
    "schemas" : {
      "ErrorInfo" : {
        "description" : "响应结果",
        "required" : [ "error_code", "error" ],
        "properties" : {
          "error_code" : {
            "type" : "string",
            "description" : "响应码,错误码规范ORGID.OAUTH.0001,数字递增"
          },
          "error_msg" : {
            "type" : "string",
            "description" : "响应描述"
          },
          "error" : {
            "type" : "string",
            "description" : "响应码,错误码规范ORGID.OAUTH.0001,数字递增,兼容原开放接口字段,值复制上方字段"
          },
          "error_description" : {
            "type" : "string",
            "description" : "响应描述,兼容原开放接口字段 ,值复制上方字段"
          }
        },
        "type" : "object"
      },
      "UserInfo" : {
        "description" : "用户信息",
        "required" : [ "tenant", "name", "mobile", "user_name", "user_id" ],
        "properties" : {
          "tenant" : {
            "type" : "string",
            "description" : "租户code,这里即企业code"
          },
          "name" : {
            "type" : "string",
            "description" : "用户显示名"
          },
          "mobile" : {
            "type" : "string",
            "description" : "手机号"
          },
          "user_name" : {
            "type" : "string",
            "description" : "用户登录账号"
          },
          "user_id" : {
            "type" : "string",
            "description" : "用户外部id"
          },
          "email" : {
            "type" : "string",
            "description" : "邮箱"
          },
          "role" : {
            "type" : "string",
            "description" : "角色,枚举:user或者admin"
          }
        },
        "type" : "object"
      },
      "ServiceResponse" : {
        "description" : "业务响应",
        "properties" : {
          "authenticationFailure" : {
            "description" : "失败响应",
            "type" : "object",
            "$ref" : "#/components/schemas/CasServiceResponseAuthenticationFailure"
          },
          "authenticationSuccess" : {
            "description" : "成功响应",
            "type" : "object",
            "$ref" : "#/components/schemas/CasServiceResponseAuthenticationSuccess"
          }
        },
        "type" : "object"
      },
      "Cas30ServiceResponse" : {
        "description" : "CAS3.0服务响应",
        "properties" : {
          "serviceResponse" : {
            "description" : "业务响应",
            "type" : "object",
            "$ref" : "#/components/schemas/ServiceResponse"
          }
        },
        "type" : "object"
      },
      "CasServiceResponseAuthenticationFailure" : {
        "description" : "CAS3.0认证失败响应",
        "properties" : {
          "code" : {
            "description" : "响应码",
            "type" : "string"
          },
          "description" : {
            "type" : "string",
            "description" : "响应描述"
          }
        },
        "type" : "object"
      },
      "CasServiceResponseAuthenticationSuccess" : {
        "description" : "CAS3.0认证成功响应",
        "properties" : {
          "user" : {
            "description" : "用户标识",
            "type" : "string"
          },
          "proxyGrantingTicket" : {
            "description" : "代理授权凭据",
            "type" : "string"
          },
          "proxies" : {
            "description" : "代理",
            "type" : "array",
            "items" : {
              "type" : "string"
            }
          },
          "attributes" : {
            "description" : "属性",
            "type" : "object",
            "$ref" : "#/components/schemas/CasAuthenticationSuccessAttributes"
          }
        },
        "type" : "object"
      },
      "CasAuthenticationSuccessAttributes" : {
        "description" : "CAS3.0认证成功响应属性",
        "properties" : {
          "authenticationDate" : {
            "description" : "认证时间",
            "type" : "string"
          },
          "longTermAuthenticationRequestTokenUsed" : {
            "description" : "longTermAuthenticationRequestTokenUsed",
            "type" : "boolean"
          },
          "isFromNewLogin" : {
            "description" : "isFromNewLogin",
            "type" : "boolean"
          },
          "token" : {
            "description" : "用户获取用户信息的token",
            "type" : "string"
          },
          "logo" : {
            "description" : "用户头像URL",
            "type" : "string"
          },
          "displayName" : {
            "description" : "用户显示名",
            "type" : "string"
          },
          "uid" : {
            "description" : "华为账号uid",
            "type" : "string"
          }
        },
        "type" : "object"
      },
      "UserTokenResponse" : {
        "description" : "用户级Token响应",
        "required" : [ "access_token", "scope", "token_type", "expires_in" ],
        "properties" : {
          "access_token" : {
            "type" : "string",
            "description" : "用户级接入token"
          },
          "refresh_token" : {
            "type" : "string",
            "description" : "用户级刷新token,离线模式适用,用于服务端主动刷新用户token"
          },
          "scope" : {
            "type" : "string",
            "description" : "授权信息范围"
          },
          "token_type" : {
            "type" : "string",
            "description" : "token类型,固定值“Bearer”,消息头传入token时前缀填入方式"
          },
          "expires_in" : {
            "type" : "integer",
            "format" : "int64",
            "description" : "token失效时长"
          }
        },
        "type" : "object"
      }
    },
    "securitySchemes" : { }
  },
  "paths" : {
    "/ShowOauth2UserInfo" : {
      "get" : {
        "tags" : [ "OAUTH" ],
        "summary" : "用户信息获取",
        "description" : "用户级Token获取",
        "operationId" : "ShowOauth2UserInfo",
        "responses" : {
          "200" : {
            "description" : "正常响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/UserInfo"
                }
              }
            }
          },
          "400" : {
            "description" : "参数错误响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorInfo"
                }
              }
            }
          },
          "401" : {
            "description" : "权限错误响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorInfo"
                }
              }
            }
          },
          "500" : {
            "description" : "系统错误响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorInfo"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "X-OrgID-Authorization",
          "in" : "header",
          "description" : "用户访问凭证,即 user_access_token, 示例值:\"Bearer u-7f1bcd13fc57d46bac21793a18e560\"",
          "required" : true,
          "schema" : {
            "description" : "用户访问凭证,即 user_access_token, 示例值:\"Bearer u-7f1bcd13fc57d46bac21793a18e560\"",
            "type" : "string"
          }
        } ],
        "security" : [ {
          "X-Auth-Token" : [ ]
        } ]
      },
      "x-method" : "get",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "ShowOauth2UserInfo",
      "x-url" : "{endpoint}/oauth2/userinfo"
    },
    "/ValidateService" : {
      "get" : {
        "tags" : [ "Cas30Service" ],
        "summary" : "验证票据接口",
        "description" : "CAS 3.0验证票据接口",
        "operationId" : "ValidateService",
        "responses" : {
          "200" : {
            "description" : "CAS3.0票据校验响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Cas30ServiceResponse"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "service",
          "in" : "query",
          "description" : "登录时携带的回调地址",
          "required" : true,
          "schema" : {
            "description" : "登录时携带的回调地址",
            "type" : "string",
            "maxLength" : 1024
          }
        }, {
          "name" : "ticket",
          "in" : "query",
          "description" : "登录时系统返回的ticket",
          "required" : true,
          "schema" : {
            "description" : "登录时系统返回的ticket",
            "type" : "string",
            "maxLength" : 128
          }
        } ],
        "security" : [ {
          "X-Auth-Token" : [ ]
        } ]
      },
      "x-method" : "get",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "ValidateService",
      "x-url" : "{endpoint}/cas/p3/serviceValidate"
    },
    "/ShowOauth2Token" : {
      "post" : {
        "tags" : [ "OAUTH" ],
        "summary" : "用户级Token获取",
        "description" : "用户级Token获取",
        "operationId" : "ShowOauth2Token",
        "responses" : {
          "200" : {
            "description" : "正常响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/UserTokenResponse"
                }
              }
            }
          },
          "400" : {
            "description" : "参数错误响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorInfo"
                }
              }
            }
          },
          "401" : {
            "description" : "权限错误响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorInfo"
                }
              }
            }
          },
          "500" : {
            "description" : "系统错误响应",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ErrorInfo"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "grant_type",
          "in" : "formData",
          "description" : "固定值authorization_code",
          "required" : true,
          "schema" : {
            "description" : "固定值authorization_code",
            "type" : "string"
          }
        }, {
          "name" : "code",
          "in" : "formData",
          "description" : "授权码",
          "required" : true,
          "schema" : {
            "description" : "授权码",
            "type" : "string"
          }
        }, {
          "name" : "client_id",
          "in" : "formData",
          "description" : "客户端应用注册ID",
          "required" : true,
          "schema" : {
            "description" : "客户端应用注册ID",
            "type" : "string"
          }
        }, {
          "name" : "client_secret",
          "in" : "formData",
          "description" : "客户端应用注册密钥",
          "required" : true,
          "schema" : {
            "description" : "客户端应用注册密钥",
            "type" : "string"
          }
        }, {
          "name" : "redirect_uri",
          "in" : "formData",
          "description" : "重定向地址,与授权码重定向地址一直,与应用注册是配置的回调地址校验需要一致",
          "required" : true,
          "schema" : {
            "description" : "重定向地址,与授权码重定向地址一直,与应用注册是配置的回调地址校验需要一致",
            "type" : "string"
          }
        }, {
          "name" : "access_type",
          "in" : "formData",
          "description" : "接入模式,默认在线模式,可不填,值为离线模式时,设置为offline会返回refresh_token",
          "required" : false,
          "schema" : {
            "description" : "接入模式,默认在线模式,可不填,值为离线模式时,设置为offline会返回refresh_token",
            "type" : "string"
          }
        } ],
        "security" : [ {
          "X-Auth-Token" : [ ]
        } ]
      },
      "x-method" : "post",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "ShowOauth2Token",
      "x-url" : "{endpoint}/oauth2/token"
    }
  }
}