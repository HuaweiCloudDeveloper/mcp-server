{
  "openapi" : "3.0.0",
  "info" : {
    "description" : "CodeCraft-作品管理",
    "title" : "CodeCraft",
    "version" : "2025-07-30",
    "x-host_prefix" : "codecraft"
  },
  "servers" : [ {
    "url" : "/"
  } ],
  "components" : {
    "parameters" : { },
    "schemas" : {
      "Error" : {
        "description" : "接口返回异常信息",
        "required" : [ "error_code", "error_msg" ],
        "properties" : {
          "error_code" : {
            "type" : "string",
            "description" : "异常错误码"
          },
          "error_msg" : {
            "type" : "string",
            "description" : "异常错误描述"
          }
        },
        "type" : "object"
      },
      "UpdateScoreRequestModel" : {
        "type" : "object",
        "required" : [ "works_id", "score", "status" ],
        "properties" : {
          "works_id" : {
            "type" : "integer",
            "format" : "int32",
            "description" : "作品ID,大赛平台提供,可以通过接口[ListCompetitionWorks](https://apiexplorer.developer.huaweicloud.com/apiexplorer/doc?product=CodeCraft&api=ListCompetitionWorks)查询作品ID",
            "example" : 4056012,
            "minimum" : 1,
            "maximum" : 2147483647
          },
          "score" : {
            "type" : "number",
            "format" : "double",
            "description" : "作品分数,作品状态为failed时传-1,计算长度时包括小数点,小数点后面最多保留四位",
            "example" : 66.66,
            "minimum" : -1,
            "maximum" : 99999999999
          },
          "status" : {
            "type" : "string",
            "description" : "作品状态success|failed。判题时,需要对上传作品进行检查,当作品不符合要求时,应该返回failed,并将提示信息通过 message显示出来",
            "example" : "success",
            "minLength" : 6,
            "maxLength" : 7,
            "enum" : [ "success", "failed" ]
          },
          "message" : {
            "type" : "string",
            "description" : "作品描述信息",
            "example" : "这是一条描述信息",
            "minLength" : 1,
            "maxLength" : 500
          }
        },
        "title" : "UpdateScoreRequestModel"
      },
      "RegisterInfoRequestModel" : {
        "type" : "object",
        "required" : [ "competition_id", "stage_id", "domain_id" ],
        "properties" : {
          "competition_id" : {
            "type" : "string",
            "description" : "大赛ID,大赛平台提供",
            "example" : "1000001898",
            "minLength" : 1,
            "maxLength" : 10
          },
          "stage_id" : {
            "type" : "string",
            "description" : "大赛阶段ID,大赛平台提供",
            "example" : "1001",
            "minLength" : 1,
            "maxLength" : 10
          },
          "domain_id" : {
            "type" : "string",
            "description" : "租户ID",
            "example" : "8624ae47cdc646e49e3fed2562c876e4",
            "minLength" : 1,
            "maxLength" : 50
          }
        },
        "title" : "RegisterInfoRequestModel"
      },
      "RegisterInfoResponseModel" : {
        "type" : "object",
        "required" : [ "is_permitted", "team_id" ],
        "properties" : {
          "is_permitted" : {
            "type" : "boolean",
            "description" : "是否允许提交作品,true-允许,false-不允许",
            "example" : true,
            "enum" : [ true, false ]
          },
          "team_id" : {
            "type" : "string",
            "description" : "团队ID",
            "example" : "2288803",
            "minLength" : 0,
            "maxLength" : 10
          }
        },
        "title" : "RegisterInfoResponseModel"
      },
      "ListWorksResponseModelList" : {
        "type" : "object",
        "required" : [ "works", "total" ],
        "properties" : {
          "works" : {
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/ListWorksResponseModel"
            },
            "description" : "作品列表",
            "minItems" : 1,
            "maxItems" : 100
          },
          "total" : {
            "type" : "integer",
            "description" : "作品总数",
            "example" : 1,
            "minimum" : 1,
            "maximum" : 9999
          }
        }
      },
      "ListWorksResponseModel" : {
        "type" : "object",
        "required" : [ "works_id", "domain_id", "team_id" ],
        "properties" : {
          "works_id" : {
            "type" : "string",
            "description" : "作品ID",
            "example" : "4056012",
            "minLength" : 1,
            "maxLength" : 10
          },
          "domain_id" : {
            "type" : "string",
            "description" : "租户ID",
            "example" : "8624ae47cdc646e49e3fed2562c876e4",
            "minLength" : 1,
            "maxLength" : 50
          },
          "team_id" : {
            "type" : "string",
            "description" : "团队ID",
            "example" : "2288803",
            "minLength" : 1,
            "maxLength" : 10
          }
        },
        "title" : "ListWorksResponseModel"
      },
      "CreateScoresResponseModel" : {
        "type" : "object",
        "required" : [ "works_id" ],
        "properties" : {
          "works_id" : {
            "type" : "string",
            "description" : "作品ID",
            "example" : "1056036",
            "minLength" : 1,
            "maxLength" : 10
          }
        },
        "title" : "CreateScoresResponseModel"
      },
      "CreateScoresRequestModel" : {
        "type" : "object",
        "required" : [ "competition_id", "stage_id", "works_id", "name", "score", "status", "created_time", "domain_id" ],
        "properties" : {
          "competition_id" : {
            "type" : "string",
            "description" : "大赛ID,大赛平台提供",
            "example" : "1000001898",
            "minLength" : 1,
            "maxLength" : 10
          },
          "stage_id" : {
            "type" : "string",
            "description" : "大赛阶段ID,大赛平台提供",
            "example" : "1001",
            "minLength" : 1,
            "maxLength" : 10
          },
          "works_id" : {
            "type" : "integer",
            "format" : "int32",
            "description" : "第三方服务作品ID",
            "example" : 4056012,
            "minimum" : 1,
            "maximum" : 2147483647
          },
          "name" : {
            "type" : "string",
            "description" : "作品名称,名称最大字符数为75,并且不能有含有特殊符号",
            "example" : "这是作品名称.zip",
            "minLength" : 1,
            "maxLength" : 75
          },
          "works_kind" : {
            "type" : "string",
            "description" : "作品类型,例如docx、png、zip等",
            "example" : "zip",
            "minLength" : 0,
            "maxLength" : 10
          },
          "score" : {
            "type" : "number",
            "format" : "double",
            "description" : "作品分数,作品状态为failed时传-1,计算长度时包括小数点,小数点后面最多保留四位",
            "example" : 66.66,
            "minimum" : -1,
            "maximum" : 99999999999
          },
          "status" : {
            "type" : "string",
            "description" : "作品状态success|failed。判题时,需要对上传作品进行检查,当作品不符合要求时,应该返回failed,并将提示信息通过 message显示出来",
            "example" : "success",
            "minLength" : 6,
            "maxLength" : 7,
            "enum" : [ "success", "failed" ]
          },
          "created_time" : {
            "type" : "string",
            "description" : "作品创建时间",
            "example" : "2021-05-20 13:45:30",
            "minLength" : 19,
            "maxLength" : 30
          },
          "note" : {
            "type" : "string",
            "description" : "作品备注信息",
            "example" : "这是作品备注信息",
            "minLength" : 0,
            "maxLength" : 100
          },
          "message" : {
            "type" : "string",
            "description" : "作品描述信息",
            "example" : "这是一条描述信息",
            "minLength" : 1,
            "maxLength" : 500
          },
          "domain_id" : {
            "type" : "string",
            "description" : "租户ID",
            "example" : "8624ae47cdc646e49e3fed2562c876e4",
            "minLength" : 1,
            "maxLength" : 50
          },
          "user_id" : {
            "type" : "string",
            "description" : "用户ID",
            "example" : "8624ae47cdc646e49e3fed2562c876e4",
            "minLength" : 1,
            "maxLength" : 50
          }
        },
        "title" : "CreateScoresRequestModel"
      }
    },
    "securitySchemes" : { }
  },
  "paths" : {
    "/UpdateCompetitionScore" : {
      "put" : {
        "tags" : [ "作品管理" ],
        "summary" : "修改平台提交的作品分数(得分回调)",
        "description" : "针对在大赛平台提交作品的场景:第三方服务对作品完成判分后,根据作品ID调用该接口将作品分数、作品状态等信息返回给大赛平台",
        "operationId" : "UpdateCompetitionScore",
        "deprecated" : false,
        "responses" : {
          "200" : {
            "description" : "分数设置成功"
          },
          "400" : {
            "description" : "作品不存在",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          },
          "403" : {
            "description" : "用户无权操作",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          },
          "500" : {
            "description" : "系统繁忙",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "x-auth-token",
          "in" : "header",
          "description" : "第三方服务token,需要平台配置账号权限",
          "required" : true,
          "schema" : {
            "example" : "MIIDkgYJKoZIhvIIDgzCCXXXXXX...",
            "description" : "第三方服务token,需要平台配置账号权限",
            "type" : "string",
            "maxLength" : 99999,
            "minLength" : 1
          }
        } ],
        "requestBody" : {
          "content" : {
            "application/json;charset=UTF-8" : {
              "schema" : {
                "$ref" : "#/components/schemas/UpdateScoreRequestModel"
              }
            }
          },
          "required" : true
        }
      },
      "x-method" : "put",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "UpdateCompetitionScore",
      "x-url" : "{endpoint}/v5/competitions/scores"
    },
    "/RegisterCompetitionInfo" : {
      "post" : {
        "tags" : [ "作品管理" ],
        "summary" : "验证用户报名信息和团队信息",
        "description" : "第三方服务验证用户是否在大赛平台报名、是否组建团队、是否可以提交作品。如果已经报名但是未组建团队,则创建一个虚拟团队,设置为允许提交作品。如果已经组建团队则根据大赛报名截止时间判断是否可以提交作品。返回团队ID、是否可以提交作品",
        "operationId" : "RegisterCompetitionInfo",
        "deprecated" : false,
        "responses" : {
          "200" : {
            "description" : "OK",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/RegisterInfoResponseModel"
                }
              }
            }
          },
          "403" : {
            "description" : "用户无权操作",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "x-auth-token",
          "in" : "header",
          "description" : "第三方token,需要平台配置账号权限",
          "required" : true,
          "schema" : {
            "example" : "MIIDkgYJKoZIhvIIDgzCCXXXXXX...",
            "description" : "第三方token,需要平台配置账号权限",
            "type" : "string",
            "maxLength" : 99999,
            "minLength" : 1
          }
        } ],
        "requestBody" : {
          "content" : {
            "application/json;charset=UTF-8" : {
              "schema" : {
                "$ref" : "#/components/schemas/RegisterInfoRequestModel"
              }
            }
          },
          "required" : true
        }
      },
      "x-method" : "post",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "RegisterCompetitionInfo",
      "x-url" : "{endpoint}/v5/competitions/registrations"
    },
    "/ListCompetitionWorks" : {
      "get" : {
        "tags" : [ "作品管理" ],
        "summary" : "获取指定时间内选手提交的作品",
        "description" : "第三方服务获取某个大赛某个阶段中一段时间内提交的作品信息。其中以请求参数read_time作为结束时间,定义向前一天或一小时内的时间作为查询范围",
        "operationId" : "ListCompetitionWorks",
        "deprecated" : false,
        "responses" : {
          "200" : {
            "description" : "查询成功",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/ListWorksResponseModelList"
                }
              }
            }
          },
          "400" : {
            "description" : "该时间段没有可判题的作品",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          },
          "403" : {
            "description" : "用户无权操作",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "x-auth-token",
          "in" : "header",
          "description" : "第三方token,需要平台配置账号权限",
          "required" : true,
          "schema" : {
            "example" : "MIIDkgYJKoZIhvIIDgzCCXXXXXX...",
            "description" : "第三方token,需要平台配置账号权限",
            "type" : "string",
            "maxLength" : 99999,
            "minLength" : 1
          }
        }, {
          "name" : "competition_id",
          "in" : "query",
          "description" : "要查询的大赛ID,由大赛平台提供",
          "required" : true,
          "schema" : {
            "example" : 1200922751,
            "description" : "要查询的大赛ID,由大赛平台提供",
            "type" : "integer",
            "format" : "int32",
            "maximum" : 2147483647,
            "minimum" : 1
          }
        }, {
          "name" : "stage_id",
          "in" : "query",
          "description" : "要查询的大赛阶段ID,由大赛平台提供",
          "required" : true,
          "schema" : {
            "example" : 1001,
            "description" : "要查询的大赛阶段ID,由大赛平台提供",
            "type" : "integer",
            "format" : "int32",
            "maximum" : 2147483647,
            "minimum" : 1
          }
        }, {
          "name" : "read_time",
          "in" : "query",
          "description" : "查询的截止时间",
          "required" : true,
          "schema" : {
            "example" : "2021-05-20 13:45:30",
            "description" : "查询的截止时间",
            "type" : "string",
            "maxLength" : 30,
            "minLength" : 19
          }
        }, {
          "name" : "time_unit",
          "in" : "query",
          "description" : "查询的时间范围。day表示以read_time作为结束时间,前一天内作为查询范围,hour表示以read_time作为结束时间,前一小内时作为查询范围。",
          "required" : false,
          "schema" : {
            "example" : "hour",
            "description" : "查询的时间范围。day表示以read_time作为结束时间,前一天内作为查询范围,hour表示以read_time作为结束时间,前一小内时作为查询范围。",
            "type" : "string",
            "default" : "day",
            "maxLength" : 10,
            "minLength" : 0,
            "enum" : [ "day", "hour" ]
          }
        }, {
          "name" : "offset",
          "in" : "query",
          "description" : "作品记录的起始编号,如果不传默认从0开始,offset为0时表示从第一条记录开始",
          "required" : false,
          "schema" : {
            "example" : 1,
            "description" : "作品记录的起始编号,如果不传默认从0开始,offset为0时表示从第一条记录开始",
            "type" : "integer",
            "maximum" : 2147483647,
            "minimum" : 0
          }
        }, {
          "name" : "limit",
          "in" : "query",
          "description" : "每页包含的作品记录数,如果不传默认返回100条,并且返回最大条数为100",
          "required" : false,
          "schema" : {
            "example" : 1,
            "description" : "每页包含的作品记录数,如果不传默认返回100条,并且返回最大条数为100",
            "type" : "integer",
            "maximum" : 100,
            "minimum" : 1
          }
        }, {
          "name" : "sort_key",
          "in" : "query",
          "description" : "需要排序的字段,只支持works_id字段,如果不传则不进行排序",
          "required" : false,
          "schema" : {
            "example" : "works_id",
            "description" : "需要排序的字段,只支持works_id字段,如果不传则不进行排序",
            "type" : "string",
            "maxLength" : 10,
            "minLength" : 0
          }
        }, {
          "name" : "sort_dir",
          "in" : "query",
          "description" : "排序类型,支持asc|desc,默认为asc升序",
          "required" : false,
          "schema" : {
            "example" : "desc",
            "description" : "排序类型,支持asc|desc,默认为asc升序",
            "type" : "string",
            "default" : "asc",
            "maxLength" : 10,
            "minLength" : 0,
            "enum" : [ "asc", "desc" ]
          }
        } ]
      },
      "x-method" : "get",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "ListCompetitionWorks",
      "x-url" : "{endpoint}/v5/competitions/works"
    },
    "/CreateCompetitionScore" : {
      "post" : {
        "tags" : [ "作品管理" ],
        "summary" : "登记第三方提交的作品信息(得分回调)",
        "description" : "针对在第三方提交作品的场景:第三方服务对作品完成判分后,调用该接口将作品信息及作品得分返回给大赛平台",
        "operationId" : "CreateCompetitionScore",
        "deprecated" : false,
        "responses" : {
          "200" : {
            "description" : "作品保存成功",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/CreateScoresResponseModel"
                }
              }
            }
          },
          "403" : {
            "description" : "用户无权操作",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          },
          "500" : {
            "description" : "系统繁忙",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "parameters" : [ {
          "name" : "x-auth-token",
          "in" : "header",
          "description" : "第三方token,需要平台配置账号权限",
          "required" : true,
          "schema" : {
            "example" : "MIIDkgYJKoZIhvIIDgzCCXXXXXX...",
            "description" : "第三方token,需要平台配置账号权限",
            "type" : "string",
            "maxLength" : 99999,
            "minLength" : 1
          }
        } ],
        "requestBody" : {
          "content" : {
            "application/json;charset=UTF-8" : {
              "schema" : {
                "$ref" : "#/components/schemas/CreateScoresRequestModel"
              }
            }
          },
          "required" : true
        }
      },
      "x-method" : "post",
      "x-content-type" : "application/json;charset=UTF-8",
      "x-operationId" : "CreateCompetitionScore",
      "x-url" : "{endpoint}/v5/competitions/score-infos"
    }
  }
}